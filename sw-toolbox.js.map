{"version":3,"sources":["node_modules/browser-pack/_prelude.js","lib/helpers.js","lib/idb-cache-expiration.js","lib/listeners.js","lib/options.js","lib/route.js","lib/router.js","lib/strategies/cacheFirst.js","lib/strategies/cacheOnly.js","lib/strategies/fastest.js","lib/strategies/index.js","lib/strategies/networkFirst.js","lib/strategies/networkOnly.js","lib/sw-notify-0.1.js","lib/sw-toolbox.js","lib/utils.js","node_modules/isarray/index.js","node_modules/path-to-regexp/index.js","node_modules/serviceworker-cache-polyfill/index.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","notify","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","globalOptions","idbCacheExpiration","notifySw","debug","message","options","flag","console","log","openCache","cacheName","cache","name","caches","open","fetchAndCache","request","successResponses","fetch","clone","then","response","method","test","status","put","cacheOptions","maxEntries","maxAgeSeconds","queueCacheExpiration","cleanupQueue","cleanup","cleanupCache","bind","requestUrl","url","now","Date","getDb","db","setTimestampForUrl","expireEntries","urlsToDelete","deletionPromises","map","urlToDelete","delete","Promise","all","catch","error","renameCache","source","destination","results","sourceCache","destCache","keys","requests","match","add","uncache","precache","items","validatePrecacheInput","preCacheItems","concat","isValid","Array","isArray","forEach","item","Request","TypeError","isResponseFresh","dateHeader","headers","get","parsedDate","getTime","fetchConfig","brandid","NOTIFYVISITORS_BRAIND_ID","undefined","resolve","reject","json","err","init","configObj","config","notifyInit","DB_PREFIX","DB_VERSION","STORE_NAME","URL_PROPERTY","TIMESTAMP_PROPERTY","cacheNameToDbPromise","openDb","indexedDB","onupgradeneeded","objectStore","result","createObjectStore","keyPath","createIndex","unique","onsuccess","onerror","transaction","timestamp","oncomplete","onabort","expireOldEntries","maxAgeMillis","urls","index","openCursor","cursorEvent","cursor","target","value","push","continue","expireExtraEntries","countRequest","count","initialCount","oldUrls","extraUrls","helpers","router","fetchListener","event","handler","respondWith","res","navigationFallback","default","indexOf","activateListener","inactiveCache","waitUntil","flatten","reduce","b","installListener","join","addAll","scope","registration","URL","location","href","networkTimeoutSeconds","basePath","pathname","pathRegexp","Route","path","RegExp","fullUrlRegExp","regexp","prototype","makeHandler","values","exec","key","regexEscape","replace","keyMatch","string","entriesIterator","entries","next","matches","done","pattern","Router","routes","Map","set","origin","toLowerCase","route","has","methodMap","routeMap","regExp","matchMethod","urlObject","_match","methodMaps","pathOrUrl","cacheFirst","cacheOnly","fastest","rejected","reasons","maybeReject","reason","toString","maybeResolve","Response","networkOnly","networkFirst","timeoutId","promises","originalResponse","cacheWhenTimedOutPromise","setTimeout","networkPromise","clearTimeout","statusText","race","utils","Notify","maxAge","maxLimit","preCache","defaultHandler","option","Object","extendedOption","extend","validateOptions","notify_toolbox","strategies","listeners","addEventListener","handlerArray","requestTypeArray","extended","deep","arguments","merge","obj","prop","hasOwnProperty","isValidArray","validateHandler","validatePreCache","configOption","setDefault","setUrls","setStatic","setDynamic","getDefaultHandler","validateRequestType","requestType","getDefaultCacheName","getDefaultMaxAge","getDefaultMaxLimit","getDefaultRequestType","_defaultRequestType","urlPattern","_requestType","_handler","_maxAge","_maxLimit","_cacheName","_origin","staticFiles","_urlPattern","dynamicFiles","regex","any","post","arr","isarray","pathToRegexp","parse","compile","tokensToFunction","tokensToRegExp","PATH_REGEXP","str","tokens","defaultDelimiter","delimiter","m","escaped","offset","slice","prefix","capture","group","modifier","asterisk","partial","repeat","optional","escapeGroup","escapeString","substr","encodeURIComponentPretty","encodeURI","c","charCodeAt","toUpperCase","encodeAsterisk","opts","data","encode","pretty","encodeURIComponent","token","segment","JSON","stringify","j","attachKeys","re","flags","sensitive","regexpToRegexp","groups","arrayToRegexp","parts","stringToRegexp","strict","end","endsWithDelimiter","nativeAddAll","Cache","userAgent","navigator","agent","version","parseInt","NetworkError","create","sequence","String","scheme","protocol","responses","some","ok"],"mappings":"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","file":"sw-toolbox.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/*\r\n  Copyright 2014 Google Inc. All Rights Reserved.\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n      http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n*/\r\n'use strict';\r\n\r\nvar globalOptions = require('./options');\r\nvar idbCacheExpiration = require('./idb-cache-expiration');\r\nvar notifySw = require('./sw-notify-0.1');\r\n\r\nfunction debug(message, options) {\r\n  options = options || {};\r\n  var flag = options.debug || globalOptions.debug;\r\n  if (flag) {\r\n    console.log('[sw-notify] ' + message);\r\n  }\r\n}\r\n\r\nfunction openCache(options) {\r\n  var cacheName;\r\n  if (options && options.cache) {\r\n    cacheName = options.cache.name;\r\n  }\r\n  cacheName = cacheName || globalOptions.cache.name;\r\n\r\n  return caches.open(cacheName);\r\n}\r\n\r\nfunction fetchAndCache(request, options) {\r\n  options = options || {};\r\n  var successResponses = options.successResponses ||\r\n    globalOptions.successResponses;\r\n\r\n  return fetch(request.clone()).then(function (response) {\r\n    // Only cache GET requests with successful responses.\r\n    // Since this is not part of the promise chain, it will be done\r\n    // asynchronously and will not block the response from being returned to the\r\n    // page.\r\n    if (request.method === 'GET' && successResponses.test(response.status)) {\r\n      openCache(options).then(function (cache) {\r\n        cache.put(request, response).then(function () {\r\n          // If any of the options are provided in options.cache then use them.\r\n          // Do not fallback to the global options for any that are missing\r\n          // unless they are all missing.\r\n          var cacheOptions = options.cache || globalOptions.cache;\r\n\r\n          // Only run the cache expiration logic if at least one of the maximums\r\n          // is set, and if we have a name for the cache that the options are\r\n          // being applied to.\r\n          if ((cacheOptions.maxEntries || cacheOptions.maxAgeSeconds) &&\r\n            cacheOptions.name) {\r\n            queueCacheExpiration(request, cache, cacheOptions);\r\n          }\r\n        });\r\n      });\r\n    }\r\n    return response.clone();\r\n  })\r\n}\r\n\r\nvar cleanupQueue;\r\nfunction queueCacheExpiration(request, cache, cacheOptions) {\r\n  var cleanup = cleanupCache.bind(null, request, cache, cacheOptions);\r\n\r\n  if (cleanupQueue) {\r\n    cleanupQueue = cleanupQueue.then(cleanup);\r\n  } else {\r\n    cleanupQueue = cleanup();\r\n  }\r\n}\r\n\r\nfunction cleanupCache(request, cache, cacheOptions) {\r\n  var requestUrl = request.url;\r\n  var maxAgeSeconds = cacheOptions.maxAgeSeconds;\r\n  var maxEntries = cacheOptions.maxEntries;\r\n  var cacheName = cacheOptions.name;\r\n\r\n  var now = Date.now();\r\n  debug('Updating LRU order for ' + requestUrl + '. Max entries is ' +\r\n    maxEntries + ', max age is ' + maxAgeSeconds);\r\n\r\n  return idbCacheExpiration.getDb(cacheName).then(function (db) {\r\n    return idbCacheExpiration.setTimestampForUrl(db, requestUrl, now);\r\n  }).then(function (db) {\r\n    return idbCacheExpiration.expireEntries(db, maxEntries, maxAgeSeconds, now);\r\n  }).then(function (urlsToDelete) {\r\n    debug('Successfully updated IDB.');\r\n\r\n    var deletionPromises = urlsToDelete.map(function (urlToDelete) {\r\n      return cache.delete(urlToDelete);\r\n    });\r\n\r\n    return Promise.all(deletionPromises).then(function () {\r\n      debug('Done with cache cleanup.');\r\n    });\r\n  }).catch(function (error) {\r\n    debug(error);\r\n  });\r\n}\r\n\r\nfunction renameCache(source, destination, options) {\r\n  debug('Renaming cache: [' + source + '] to [' + destination + ']', options);\r\n  return caches.delete(destination).then(function () {\r\n    return Promise.all([\r\n      caches.open(source),\r\n      caches.open(destination)\r\n    ]).then(function (results) {\r\n      var sourceCache = results[0];\r\n      var destCache = results[1];\r\n\r\n      return sourceCache.keys().then(function (requests) {\r\n        return Promise.all(requests.map(function (request) {\r\n          return sourceCache.match(request).then(function (response) {\r\n            return destCache.put(request, response);\r\n          });\r\n        }));\r\n      }).then(function () {\r\n        return caches.delete(source);\r\n      });\r\n    });\r\n  });\r\n}\r\n\r\nfunction cache(url, options) {\r\n  return openCache(options).then(function (cache) {\r\n    return cache.add(url);\r\n  });\r\n}\r\n\r\nfunction uncache(url, options) {\r\n  return openCache(options).then(function (cache) {\r\n    return cache.delete(url);\r\n  });\r\n}\r\n\r\nfunction precache(items) {\r\n  if (!(items instanceof Promise)) {\r\n    validatePrecacheInput(items);\r\n  }\r\n\r\n  globalOptions.preCacheItems = globalOptions.preCacheItems.concat(items);\r\n}\r\n\r\nfunction validatePrecacheInput(items) {\r\n  var isValid = Array.isArray(items);\r\n  if (isValid) {\r\n    items.forEach(function (item) {\r\n      if (!(typeof item === 'string' || (item instanceof Request))) {\r\n        isValid = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  if (!isValid) {\r\n    throw new TypeError('The precache method expects either an array of ' +\r\n      'strings and/or Requests or a Promise that resolves to an array of ' +\r\n      'strings and/or Requests.');\r\n  }\r\n\r\n  return items;\r\n}\r\n\r\nfunction isResponseFresh(response, maxAgeSeconds, now) {\r\n  // If we don't have a response, then it's not fresh.\r\n  if (!response) {\r\n    return false;\r\n  }\r\n\r\n  // Only bother checking the age of the response if maxAgeSeconds is set.\r\n  if (maxAgeSeconds) {\r\n    var dateHeader = response.headers.get('date');\r\n    // If there's no Date: header, then fall through and return true.\r\n    if (dateHeader) {\r\n      var parsedDate = new Date(dateHeader);\r\n      // If the Date: header was invalid for some reason, parsedDate.getTime()\r\n      // will return NaN, and the comparison will always be false. That means\r\n      // that an invalid date will be treated as if the response is fresh.\r\n      if ((parsedDate.getTime() + (maxAgeSeconds * 1000)) < now) {\r\n        // Only return false if all the other conditions are met.\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Fall back on returning true by default, to match the previous behavior in\r\n  // which we never bothered checking to see whether the response was fresh.\r\n  return true;\r\n}\r\n\r\nfunction fetchConfig() {\r\n  var brandid = NOTIFYVISITORS_BRAIND_ID || typeof undefined;\r\n  if (brandid ==='undefined') {\r\n    return new Promise(function (resolve, reject) {\r\n      resolve(null);\r\n    })\r\n  } else {\r\n    return fetch('https://devpush.notifyvisitors.com/pwa/sw/notification?brandid=' + brandid)\r\n      .then(function (response) {\r\n        return response.json();\r\n      }).catch(function(err){\r\n        debug('error during fetching config ::' + err);\r\n        return null;\r\n      });\r\n  }\r\n}\r\nfunction init() {\r\n  return new Promise(function (resolve, reject) {\r\n    fetchConfig().then(function (configObj) {\r\n      // console.log(globalOptions);\r\n      // console.log(configObj);\r\n      if (configObj && typeof configObj === 'object') {\r\n        var config = configObj.config;\r\n        if (config && typeof config === 'object') {\r\n\r\n          notifySw.notifyInit(config);\r\n          resolve();\r\n        } else {\r\n          notifySw.notifyInit();\r\n          resolve();\r\n        }\r\n      } else {\r\n        notifySw.notifyInit();\r\n        resolve();\r\n      }\r\n    })\r\n  })\r\n}\r\nmodule.exports = {\r\n  debug: debug,\r\n  fetchAndCache: fetchAndCache,\r\n  openCache: openCache,\r\n  renameCache: renameCache,\r\n  cache: cache,\r\n  uncache: uncache,\r\n  precache: precache,\r\n  validatePrecacheInput: validatePrecacheInput,\r\n  isResponseFresh: isResponseFresh,\r\n  globalOptions: globalOptions,\r\n  init: init\r\n};\r\n","/*\r\n Copyright 2015 Google Inc. All Rights Reserved.\r\n\r\n Licensed under the Apache License, Version 2.0 (the \"License\");\r\n you may not use this file except in compliance with the License.\r\n You may obtain a copy of the License at\r\n\r\n     http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n Unless required by applicable law or agreed to in writing, software\r\n distributed under the License is distributed on an \"AS IS\" BASIS,\r\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n See the License for the specific language governing permissions and\r\n limitations under the License.\r\n*/\r\n'use strict';\r\n\r\nvar DB_PREFIX = 'sw-toolbox-';\r\nvar DB_VERSION = 1;\r\nvar STORE_NAME = 'store';\r\nvar URL_PROPERTY = 'url';\r\nvar TIMESTAMP_PROPERTY = 'timestamp';\r\nvar cacheNameToDbPromise = {};\r\n\r\nfunction openDb(cacheName) {\r\n  return new Promise(function(resolve, reject) {\r\n    var request = indexedDB.open(DB_PREFIX + cacheName, DB_VERSION);\r\n\r\n    request.onupgradeneeded = function() {\r\n      var objectStore = request.result.createObjectStore(STORE_NAME,\r\n          {keyPath: URL_PROPERTY});\r\n      objectStore.createIndex(TIMESTAMP_PROPERTY, TIMESTAMP_PROPERTY,\r\n          {unique: false});\r\n    };\r\n\r\n    request.onsuccess = function() {\r\n      resolve(request.result);\r\n    };\r\n\r\n    request.onerror = function() {\r\n      reject(request.error);\r\n    };\r\n  });\r\n}\r\n\r\nfunction getDb(cacheName) {\r\n  if (!(cacheName in cacheNameToDbPromise)) {\r\n    cacheNameToDbPromise[cacheName] = openDb(cacheName);\r\n  }\r\n\r\n  return cacheNameToDbPromise[cacheName];\r\n}\r\n\r\nfunction setTimestampForUrl(db, url, now) {\r\n  return new Promise(function(resolve, reject) {\r\n    var transaction = db.transaction(STORE_NAME, 'readwrite');\r\n    var objectStore = transaction.objectStore(STORE_NAME);\r\n    objectStore.put({url: url, timestamp: now});\r\n\r\n    transaction.oncomplete = function() {\r\n      resolve(db);\r\n    };\r\n\r\n    transaction.onabort = function() {\r\n      reject(transaction.error);\r\n    };\r\n  });\r\n}\r\n\r\nfunction expireOldEntries(db, maxAgeSeconds, now) {\r\n  // Bail out early by resolving with an empty array if we're not using\r\n  // maxAgeSeconds.\r\n  if (!maxAgeSeconds) {\r\n    return Promise.resolve([]);\r\n  }\r\n\r\n  return new Promise(function(resolve, reject) {\r\n    var maxAgeMillis = maxAgeSeconds * 1000;\r\n    var urls = [];\r\n\r\n    var transaction = db.transaction(STORE_NAME, 'readwrite');\r\n    var objectStore = transaction.objectStore(STORE_NAME);\r\n    var index = objectStore.index(TIMESTAMP_PROPERTY);\r\n\r\n    index.openCursor().onsuccess = function(cursorEvent) {\r\n      var cursor = cursorEvent.target.result;\r\n      if (cursor) {\r\n        if (now - maxAgeMillis > cursor.value[TIMESTAMP_PROPERTY]) {\r\n          var url = cursor.value[URL_PROPERTY];\r\n          urls.push(url);\r\n          objectStore.delete(url);\r\n          cursor.continue();\r\n        }\r\n      }\r\n    };\r\n\r\n    transaction.oncomplete = function() {\r\n      resolve(urls);\r\n    };\r\n\r\n    transaction.onabort = reject;\r\n  });\r\n}\r\n\r\nfunction expireExtraEntries(db, maxEntries) {\r\n  // Bail out early by resolving with an empty array if we're not using\r\n  // maxEntries.\r\n  if (!maxEntries) {\r\n    return Promise.resolve([]);\r\n  }\r\n\r\n  return new Promise(function(resolve, reject) {\r\n    var urls = [];\r\n\r\n    var transaction = db.transaction(STORE_NAME, 'readwrite');\r\n    var objectStore = transaction.objectStore(STORE_NAME);\r\n    var index = objectStore.index(TIMESTAMP_PROPERTY);\r\n\r\n    var countRequest = index.count();\r\n    index.count().onsuccess = function() {\r\n      var initialCount = countRequest.result;\r\n\r\n      if (initialCount > maxEntries) {\r\n        index.openCursor().onsuccess = function(cursorEvent) {\r\n          var cursor = cursorEvent.target.result;\r\n          if (cursor) {\r\n            var url = cursor.value[URL_PROPERTY];\r\n            urls.push(url);\r\n            objectStore.delete(url);\r\n            if (initialCount - urls.length > maxEntries) {\r\n              cursor.continue();\r\n            }\r\n          }\r\n        };\r\n      }\r\n    };\r\n\r\n    transaction.oncomplete = function() {\r\n      resolve(urls);\r\n    };\r\n\r\n    transaction.onabort = reject;\r\n  });\r\n}\r\n\r\nfunction expireEntries(db, maxEntries, maxAgeSeconds, now) {\r\n  return expireOldEntries(db, maxAgeSeconds, now).then(function(oldUrls) {\r\n    return expireExtraEntries(db, maxEntries).then(function(extraUrls) {\r\n      return oldUrls.concat(extraUrls);\r\n    });\r\n  });\r\n}\r\n\r\nmodule.exports = {\r\n  getDb: getDb,\r\n  setTimestampForUrl: setTimestampForUrl,\r\n  expireEntries: expireEntries\r\n};\r\n","/*\r\n  Copyright 2014 Google Inc. All Rights Reserved.\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n      http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n*/\r\n'use strict';\r\n\r\n// For cache.addAll.\r\nrequire('serviceworker-cache-polyfill');\r\n\r\nvar helpers = require('./helpers');\r\nvar router = require('./router');\r\nvar options = require('./options');\r\n\r\n// Event listeners\r\n\r\nfunction fetchListener(event) {\r\n  var handler = router.match(event.request);\r\n  if (handler) {\r\n    event.respondWith(handler(event.request).then(function (res) {\r\n\r\n      return res;\r\n    }).catch(function (err) {\r\n      // console.log(err);\r\n      return helpers.openCache(helpers.globalOptions.cache.name).then(function (cache) {\r\n        return cache.match(helpers.globalOptions.navigationFallback).then(function (res) {\r\n\r\n          return res;\r\n        })\r\n      });\r\n    }));\r\n  } else if (router.default &&\r\n    event.request.method === 'GET' &&\r\n    // Ensure that chrome-extension:// requests don't trigger the default route.\r\n    event.request.url.indexOf('http') === 0) {\r\n    event.respondWith(router.default(event.request).then(function (res) {\r\n\r\n      return res;\r\n    }).catch(function (err) {\r\n      // console.log(err);\r\n      return helpers.openCache(helpers.globalOptions.cache.name).then(function (cache) {\r\n        return cache.match(helpers.globalOptions.navigationFallback).then(function (res) {\r\n          return res;\r\n        })\r\n      });\r\n    }));\r\n  }\r\n}\r\n\r\nfunction activateListener(event) {\r\n  helpers.debug('activate event fired');\r\n  var inactiveCache = options.cache.name + '$$$inactive$$$';\r\n  event.waitUntil(helpers.renameCache(inactiveCache, options.cache.name));\r\n}\r\n\r\nfunction flatten(items) {\r\n  return items.reduce(function (a, b) {\r\n    return a.concat(b);\r\n  }, []);\r\n}\r\n\r\nfunction installListener(event) {\r\n\r\n\r\n  helpers.debug('install event fired');\r\n  // helpers.debug('creating cache [' + inactiveCache + ']');\r\n  event.waitUntil(\r\n    helpers.init().then(function () {\r\n      var inactiveCache = options.cache.name + '$$$inactive$$$';\r\n      helpers.debug('creating cache [' + inactiveCache + ']');\r\n      return helpers.openCache({ cache: { name: inactiveCache } })\r\n        .then(function (cache) {\r\n          return Promise.all(options.preCacheItems)\r\n            .then(flatten)\r\n            .then(helpers.validatePrecacheInput)\r\n            .then(function (preCacheItems) {\r\n              helpers.debug('preCache list: ' +\r\n                (preCacheItems.join(', ') || '(none)'));\r\n              return cache.addAll(preCacheItems);\r\n            });\r\n        })\r\n    })\r\n  );\r\n}\r\n\r\nmodule.exports = {\r\n  fetchListener: fetchListener,\r\n  activateListener: activateListener,\r\n  installListener: installListener\r\n};\r\n","/*\r\n\tCopyright 2015 Google Inc. All Rights Reserved.\r\n\r\n\tLicensed under the Apache License, Version 2.0 (the \"License\");\r\n\tyou may not use this file except in compliance with the License.\r\n\tYou may obtain a copy of the License at\r\n\r\n      http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n\tUnless required by applicable law or agreed to in writing, software\r\n\tdistributed under the License is distributed on an \"AS IS\" BASIS,\r\n\tWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n\tSee the License for the specific language governing permissions and\r\n\tlimitations under the License.\r\n*/\r\n'use strict';\r\n\r\n// TODO: This is necessary to handle different implementations in the wild\r\n// The spec defines self.registration, but it was not implemented in Chrome 40.\r\nvar scope;\r\nif (self.registration) {\r\n  scope = self.registration.scope;\r\n} else {\r\n  scope = self.scope || new URL('./', self.location).href;\r\n}\r\n\r\nmodule.exports = {\r\n  cache: {\r\n    name: '$$$notify-cache$$$' + scope + '$$$',\r\n    maxAgeSeconds: null,\r\n    maxEntries: null\r\n  },\r\n  debug: false,\r\n  networkTimeoutSeconds: null,\r\n  preCacheItems: [],\r\n  // A regular expression to apply to HTTP response codes. Codes that match\r\n  // will be considered successes, while others will not, and will not be\r\n  // cached.\r\n  successResponses: /^0|([123]\\d\\d)|(40[14567])|410$/,\r\n  navigationFallback: ''\r\n};\r\n","/*\r\n  Copyright 2014 Google Inc. All Rights Reserved.\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n      http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n*/\r\n'use strict';\r\n\r\n// TODO: Use self.registration.scope instead of self.location\r\nvar url = new URL('./', self.location);\r\nvar basePath = url.pathname;\r\nvar pathRegexp = require('path-to-regexp');\r\n\r\nvar Route = function(method, path, handler, options) {\r\n  if (path instanceof RegExp) {\r\n    this.fullUrlRegExp = path;\r\n  } else {\r\n    // The URL() constructor can't parse express-style routes as they are not\r\n    // valid urls. This means we have to manually manipulate relative urls into\r\n    // absolute ones. This check is extremely naive but implementing a tweaked\r\n    // version of the full algorithm seems like overkill\r\n    // (https://url.spec.whatwg.org/#concept-basic-url-parser)\r\n    if (path.indexOf('/') !== 0) {\r\n      path = basePath + path;\r\n    }\r\n\r\n    this.keys = [];\r\n    this.regexp = pathRegexp(path, this.keys);\r\n  }\r\n\r\n  this.method = method;\r\n  this.options = options;\r\n  this.handler = handler;\r\n};\r\n\r\nRoute.prototype.makeHandler = function(url) {\r\n  var values;\r\n  if (this.regexp) {\r\n    var match = this.regexp.exec(url);\r\n    values = {};\r\n    this.keys.forEach(function(key, index) {\r\n      values[key.name] = match[index + 1];\r\n    });\r\n  }\r\n\r\n  return function(request) {\r\n    return this.handler(request, values, this.options);\r\n  }.bind(this);\r\n};\r\n\r\nmodule.exports = Route;\r\n","/*\r\n  Copyright 2014 Google Inc. All Rights Reserved.\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n      http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n*/\r\n'use strict';\r\n\r\nvar Route = require('./route');\r\nvar helpers = require('./helpers');\r\n\r\nfunction regexEscape(s) {\r\n  return s.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\r\n}\r\n\r\nvar keyMatch = function (map, string) {\r\n  // This would be better written as a for..of loop, but that would break the\r\n  // minifyify process in the build.\r\n  var entriesIterator = map.entries();\r\n  var item = entriesIterator.next();\r\n  var matches = [];\r\n  while (!item.done) {\r\n    var pattern = new RegExp(item.value[0]);\r\n    if (pattern.test(string)) {\r\n      matches.push(item.value[1]);\r\n    }\r\n    item = entriesIterator.next();\r\n  }\r\n  return matches;\r\n};\r\n\r\nvar Router = function () {\r\n  this.routes = new Map();\r\n  // Create the dummy origin for RegExp-based routes\r\n  this.routes.set(RegExp, new Map());\r\n  this.default = null;\r\n};\r\n\r\n['get', 'post', 'put', 'delete', 'head', 'any'].forEach(function (method) {\r\n  Router.prototype[method] = function (path, handler, options) {\r\n    return this.add(method, path, handler, options);\r\n  };\r\n});\r\n\r\nRouter.prototype.add = function (method, path, handler, options) {\r\n  options = options || {};\r\n  var origin;\r\n\r\n  if (path instanceof RegExp) {\r\n    // We need a unique key to use in the Map to distinguish RegExp paths\r\n    // from Express-style paths + origins. Since we can use any object as the\r\n    // key in a Map, let's use the RegExp constructor!\r\n    origin = RegExp;\r\n  } else {\r\n    origin = options.origin || self.location.origin;\r\n    if (origin instanceof RegExp) {\r\n      origin = origin.source;\r\n    } else {\r\n      origin = regexEscape(origin);\r\n    }\r\n  }\r\n\r\n  method = method.toLowerCase();\r\n\r\n  var route = new Route(method, path, handler, options);\r\n\r\n  if (!this.routes.has(origin)) {\r\n    this.routes.set(origin, new Map());\r\n  }\r\n\r\n  var methodMap = this.routes.get(origin);\r\n  if (!methodMap.has(method)) {\r\n    methodMap.set(method, new Map());\r\n  }\r\n\r\n  var routeMap = methodMap.get(method);\r\n  var regExp = route.regexp || route.fullUrlRegExp;\r\n\r\n  if (routeMap.has(regExp.source)) {\r\n    helpers.debug('\"' + path + '\" resolves to same regex as existing route.');\r\n  }\r\n\r\n  routeMap.set(regExp.source, route);\r\n};\r\n\r\nRouter.prototype.matchMethod = function (method, url) {\r\n  var urlObject = new URL(url);\r\n  var origin = urlObject.origin;\r\n  var path = urlObject.pathname;\r\n\r\n  // We want to first check to see if there's a match against any\r\n  // \"Express-style\" routes (string for the path, RegExp for the origin).\r\n  // Checking for Express-style matches first maintains the legacy behavior.\r\n  // If there's no match, we next check for a match against any RegExp routes,\r\n  // where the RegExp in question matches the full URL (both origin and path).\r\n  return this._match(method, keyMatch(this.routes, origin), path) ||\r\n    this._match(method, [this.routes.get(RegExp)], url);\r\n};\r\n\r\nRouter.prototype._match = function (method, methodMaps, pathOrUrl) {\r\n  if (methodMaps.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  for (var i = 0; i < methodMaps.length; i++) {\r\n    var methodMap = methodMaps[i];\r\n    var routeMap = methodMap && methodMap.get(method.toLowerCase());\r\n    if (routeMap) {\r\n      var routes = keyMatch(routeMap, pathOrUrl);\r\n      if (routes.length > 0) {\r\n        return routes[0].makeHandler(pathOrUrl);\r\n      }\r\n    }\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nRouter.prototype.match = function (request) {\r\n  return this.matchMethod(request.method, request.url) ||\r\n    this.matchMethod('any', request.url);\r\n};\r\n\r\nmodule.exports = new Router();\r\n","/*\r\n\tCopyright 2014 Google Inc. All Rights Reserved.\r\n\r\n\tLicensed under the Apache License, Version 2.0 (the \"License\");\r\n\tyou may not use this file except in compliance with the License.\r\n\tYou may obtain a copy of the License at\r\n\r\n      http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n\tUnless required by applicable law or agreed to in writing, software\r\n\tdistributed under the License is distributed on an \"AS IS\" BASIS,\r\n\tWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n\tSee the License for the specific language governing permissions and\r\n\tlimitations under the License.\r\n*/\r\n'use strict';\r\nvar globalOptions = require('../options');\r\nvar helpers = require('../helpers');\r\n\r\nfunction cacheFirst(request, values, options) {\r\n  options = options || {};\r\n  helpers.debug('Strategy: cache first [' + request.url + ']', options);\r\n  return helpers.openCache(options).then(function(cache) {\r\n    return cache.match(request).then(function(response) {\r\n      var cacheOptions = options.cache || globalOptions.cache;\r\n      var now = Date.now();\r\n      if (helpers.isResponseFresh(response, cacheOptions.maxAgeSeconds, now)) {\r\n        return response;\r\n      }\r\n\r\n      return helpers.fetchAndCache(request, options);\r\n    });\r\n  });\r\n}\r\n\r\nmodule.exports = cacheFirst;\r\n","/*\r\n\tCopyright 2014 Google Inc. All Rights Reserved.\r\n\r\n\tLicensed under the Apache License, Version 2.0 (the \"License\");\r\n\tyou may not use this file except in compliance with the License.\r\n\tYou may obtain a copy of the License at\r\n\r\n      http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n\tUnless required by applicable law or agreed to in writing, software\r\n\tdistributed under the License is distributed on an \"AS IS\" BASIS,\r\n\tWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n\tSee the License for the specific language governing permissions and\r\n\tlimitations under the License.\r\n*/\r\n'use strict';\r\nvar globalOptions = require('../options');\r\nvar helpers = require('../helpers');\r\n\r\nfunction cacheOnly(request, values, options) {\r\n  options = options || {};\r\n  helpers.debug('Strategy: cache only [' + request.url + ']', options);\r\n  return helpers.openCache(options).then(function(cache) {\r\n    return cache.match(request).then(function(response) {\r\n      var cacheOptions = options.cache || globalOptions.cache;\r\n      var now = Date.now();\r\n      if (helpers.isResponseFresh(response, cacheOptions.maxAgeSeconds, now)) {\r\n        return response;\r\n      }\r\n\r\n      return undefined;\r\n    });\r\n  });\r\n}\r\n\r\nmodule.exports = cacheOnly;\r\n","/*\r\n  Copyright 2014 Google Inc. All Rights Reserved.\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n      http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n*/\r\n'use strict';\r\nvar helpers = require('../helpers');\r\nvar cacheOnly = require('./cacheOnly');\r\n\r\nfunction fastest(request, values, options) {\r\n  helpers.debug('Strategy: fastest [' + request.url + ']', options);\r\n\r\n  return new Promise(function(resolve, reject) {\r\n    var rejected = false;\r\n    var reasons = [];\r\n\r\n    var maybeReject = function(reason) {\r\n      reasons.push(reason.toString());\r\n      if (rejected) {\r\n            reject(new Error('Both cache and network failed: \"' +\r\n            reasons.join('\", \"') + '\"'));\r\n            // resolve(\r\n            //   helpers.openCache(helpers.globalOptions.cache.name).then(function(cache){\r\n            //   return cache.match('/offline').then(function(res){\r\n            //     return res;\r\n            //   })\r\n            // }))\r\n      } else {\r\n        rejected = true;\r\n      }\r\n    };\r\n\r\n    var maybeResolve = function(result) {\r\n      if (result instanceof Response) {\r\n        resolve(result);\r\n      } else {\r\n        maybeReject('No result returned');\r\n      }\r\n    };\r\n\r\n    helpers.fetchAndCache(request.clone(), options)\r\n      .then(maybeResolve, maybeReject);\r\n\r\n    cacheOnly(request, values, options)\r\n      .then(maybeResolve, maybeReject);\r\n  });\r\n}\r\n\r\nmodule.exports = fastest;\r\n","/*\r\n\tCopyright 2014 Google Inc. All Rights Reserved.\r\n\r\n\tLicensed under the Apache License, Version 2.0 (the \"License\");\r\n\tyou may not use this file except in compliance with the License.\r\n\tYou may obtain a copy of the License at\r\n\r\n      http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n\tUnless required by applicable law or agreed to in writing, software\r\n\tdistributed under the License is distributed on an \"AS IS\" BASIS,\r\n\tWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n\tSee the License for the specific language governing permissions and\r\n\tlimitations under the License.\r\n*/\r\nmodule.exports = {\r\n  networkOnly: require('./networkOnly'),\r\n  networkFirst: require('./networkFirst'),\r\n  cacheOnly: require('./cacheOnly'),\r\n  cacheFirst: require('./cacheFirst'),\r\n  fastest: require('./fastest')\r\n};\r\n","/*\r\n Copyright 2015 Google Inc. All Rights Reserved.\r\n\r\n Licensed under the Apache License, Version 2.0 (the \"License\");\r\n you may not use this file except in compliance with the License.\r\n You may obtain a copy of the License at\r\n\r\n     http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n Unless required by applicable law or agreed to in writing, software\r\n distributed under the License is distributed on an \"AS IS\" BASIS,\r\n WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n See the License for the specific language governing permissions and\r\n limitations under the License.\r\n*/\r\n'use strict';\r\nvar globalOptions = require('../options');\r\nvar helpers = require('../helpers');\r\n\r\nfunction networkFirst(request, values, options) {\r\n  options = options || {};\r\n  var successResponses = options.successResponses ||\r\n      globalOptions.successResponses;\r\n  // This will bypass options.networkTimeout if it's set to a false-y value like\r\n  // 0, but that's the sane thing to do anyway.\r\n  var networkTimeoutSeconds = options.networkTimeoutSeconds ||\r\n      globalOptions.networkTimeoutSeconds;\r\n  helpers.debug('Strategy: network first [' + request.url + ']', options);\r\n\r\n  return helpers.openCache(options).then(function(cache) {\r\n    var timeoutId;\r\n    var promises = [];\r\n    var originalResponse;\r\n\r\n    if (networkTimeoutSeconds) {\r\n      var cacheWhenTimedOutPromise = new Promise(function(resolve) {\r\n        timeoutId = setTimeout(function() {\r\n          cache.match(request).then(function(response) {\r\n            var cacheOptions = options.cache || globalOptions.cache;\r\n            // Only resolve this promise if there's a valid response in the\r\n            // cache. This ensures that we won't time out a network request\r\n            // unless there's a cached entry to fallback on, which is arguably\r\n            // the preferable behavior.\r\n            var now = Date.now();\r\n            var maxAgeSeconds = cacheOptions.maxAgeSeconds;\r\n            if (helpers.isResponseFresh(response, maxAgeSeconds, now)) {\r\n              resolve(response);\r\n            }\r\n          });\r\n        }, networkTimeoutSeconds * 1000);\r\n      });\r\n      promises.push(cacheWhenTimedOutPromise);\r\n    }\r\n\r\n    var networkPromise = helpers.fetchAndCache(request, options)\r\n      .then(function(response) {\r\n        // We've got a response, so clear the network timeout if there is one.\r\n        if (timeoutId) {\r\n          clearTimeout(timeoutId);\r\n        }\r\n\r\n        if (successResponses.test(response.status)) {\r\n          return response;\r\n        }\r\n\r\n        helpers.debug('Response was an HTTP error: ' + response.statusText,\r\n            options);\r\n        originalResponse = response;\r\n        throw new Error('Bad response');\r\n      }).catch(function(error) {\r\n        helpers.debug('Network or response error, fallback to cache [' +\r\n            request.url + ']', options);\r\n        return cache.match(request).then(function(response) {\r\n          // If there's a match in the cache, resolve with that.\r\n          if (response) {\r\n            return response;\r\n          }\r\n\r\n          // If we have a Response object from the previous fetch, then resolve\r\n          // with that, even though it corresponds to an error status code.\r\n          if (originalResponse) {\r\n            return originalResponse;\r\n          }\r\n\r\n          // If we don't have a Response object from the previous fetch, likely\r\n          // due to a network failure, then reject with the failure error.\r\n          throw error;\r\n        });\r\n      });\r\n\r\n    promises.push(networkPromise);\r\n\r\n    return Promise.race(promises);\r\n  });\r\n}\r\n\r\nmodule.exports = networkFirst;\r\n","/*\r\n\tCopyright 2014 Google Inc. All Rights Reserved.\r\n\r\n\tLicensed under the Apache License, Version 2.0 (the \"License\");\r\n\tyou may not use this file except in compliance with the License.\r\n\tYou may obtain a copy of the License at\r\n\r\n      http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n\tUnless required by applicable law or agreed to in writing, software\r\n\tdistributed under the License is distributed on an \"AS IS\" BASIS,\r\n\tWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n\tSee the License for the specific language governing permissions and\r\n\tlimitations under the License.\r\n*/\r\n'use strict';\r\nvar helpers = require('../helpers');\r\n\r\nfunction networkOnly(request, values, options) {\r\n  helpers.debug('Strategy: network only [' + request.url + ']', options);\r\n  return fetch(request).then(function(response){\r\n\t  return response;\r\n  })\r\n//   .catch(function(err){\r\n// \t   return helpers.openCache(helpers.globalOptions.cache.name).then(function(cache){\r\n// \t\t  return cache.match('/offline').then(function(response){\r\n// \t\t\t  return response;\r\n// \t\t  });\r\n// \t  })\r\n//   });\r\n}\r\n\r\nmodule.exports = networkOnly;\r\n","//    Copyright 2017 Satyam Singh (satyam0507@gmail.com) All Rights Reserved.\r\n// \r\n//    Licensed under the Apache License, Version 2.0 (the \"License\");\r\n//    you may not use this file except in compliance with the License.\r\n//    You may obtain a copy of the License at\r\n// \r\n//        http://www.apache.org/licenses/LICENSE-2.0\r\n// \r\n//    Unless required by applicable law or agreed to in writing, software\r\n//    distributed under the License is distributed on an \"AS IS\" BASIS,\r\n//    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n//    See the License for the specific language governing permissions and\r\n//    limitations under the License.\r\n\r\n\r\n'use strict';\r\n\r\nvar utils = require('./utils');\r\n\r\nvar Notify = function () {\r\n\r\n    // default option \r\n\r\n    // @ option.cache ::- contain the default configuration about the cache\r\n    // @ option.cache.name ::- default name of the primary cache if not provided then 'notify-1'            \r\n    // @ option.cache.maxAge ::-  time in second after which response is will be consider fresh            \r\n    // @ option.cache.maxLimit ::- max limit of entries in the cache                             \r\n    //              \r\n    this.options = {\r\n        cache: {\r\n            name: 'notify-2',\r\n            maxAge: 604800,\r\n            maxLimit: 1000\r\n        },\r\n        // @ option.preCache ::- Array that contain urlPattern that will be precache at \r\n        //                       install phase of the service worker\r\n        preCache: [\r\n\r\n        ],\r\n        // @ defaultHandler ::- it is the default handler for the Requests \r\n        defaultHandler: 'networkFirst',\r\n        // @ navigationFallback ::- fallback page which will be served if both network and cache request fails\r\n        navigationFallback: '/' //todo link to our custom offline page\r\n\r\n    };\r\n\r\n}\r\n\r\nNotify.prototype.init = function (option) {\r\n\r\n    // chech if option object is avaliable and has keys\r\n    if (typeof option === 'object' && Object.keys(option).length >= 1) {\r\n\r\n        //object is valid and has keys\r\n\r\n        // extend the option with default option\r\n        var extendedOption = utils.extend(this.options, option);\r\n\r\n        if (utils.validateOptions(extendedOption)) {\r\n\r\n            console.log('option is valid');\r\n            this.options = extendedOption;\r\n            utils.notify_toolbox(extendedOption);\r\n\r\n        } else {\r\n            console.log('option is invalid');\r\n        }\r\n    } else {\r\n        // object is not valid or does not have keys\r\n        //  extend default values\r\n\r\n        console.log('initializing with default values');\r\n        option = this.options;\r\n        utils.notify_toolbox(option);\r\n    }\r\n\r\n}\r\n\r\n\r\nfunction notifyInit(configObj) {\r\n    var notify = new Notify();\r\n    notify.init(configObj);\r\n}\r\n\r\nmodule.exports = {\r\n    notifyInit: notifyInit\r\n}","/*\r\n  Copyright 2014 Google Inc. All Rights Reserved.\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n      http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n*/\r\n'use strict';\r\n\r\n// This is the entrypoint for the sw-toolbox bundle. All code with\r\n// side effects (e.g. adding event listeners) should be in this file.\r\n\r\nvar options = require('./options');\r\nvar router = require('./router');\r\nvar helpers = require('./helpers');\r\nvar strategies = require('./strategies');\r\nvar listeners = require('./listeners');\r\n\r\nhelpers.debug('Service Worker Toolbox is loading');\r\n\r\n// Set up listeners.\r\n\r\nself.addEventListener('install', listeners.installListener);\r\nself.addEventListener('activate', listeners.activateListener);\r\nself.addEventListener('fetch', listeners.fetchListener);\r\n\r\nmodule.exports = {\r\n  networkOnly: strategies.networkOnly,\r\n  networkFirst: strategies.networkFirst,\r\n  cacheOnly: strategies.cacheOnly,\r\n  cacheFirst: strategies.cacheFirst,\r\n  fastest: strategies.fastest,\r\n  router: router,\r\n  options: options,\r\n  cache: helpers.cache,\r\n  uncache: helpers.uncache,\r\n  precache: helpers.precache\r\n};\r\n","//    Copyright 2017 Satyam Singh (satyam0507@gmail.com) All Rights Reserved.\r\n// \r\n//    Licensed under the Apache License, Version 2.0 (the \"License\");\r\n//    you may not use this file except in compliance with the License.\r\n//    You may obtain a copy of the License at\r\n// \r\n//        http://www.apache.org/licenses/LICENSE-2.0\r\n// \r\n//    Unless required by applicable law or agreed to in writing, software\r\n//    distributed under the License is distributed on an \"AS IS\" BASIS,\r\n//    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n//    See the License for the specific language governing permissions and\r\n//    limitations under the License.\r\n\r\n'use strict';\r\n\r\nvar handlerArray = ['cacheFirst', 'cacheOnly', 'fastest', 'networkFirst', 'networkOnly'];\r\nvar requestTypeArray = ['get', 'post', 'put', 'delete', 'head'];\r\n\r\n\r\nvar extend = function () {\r\n\r\n\r\n    // Variables\r\n    var extended = {};\r\n    var deep = true;\r\n    var i = 0;\r\n    var length = arguments.length;\r\n\r\n    // Check if a deep merge\r\n    if (Object.prototype.toString.call(arguments[0]) === '[object Boolean]') {\r\n        deep = arguments[0];\r\n        i++;\r\n    }\r\n\r\n    // Merge the object into the extended object\r\n    var merge = function (obj) {\r\n        for (var prop in obj) {\r\n            if (Object.prototype.hasOwnProperty.call(obj, prop)) {\r\n                // If deep merge and property is an object, merge properties\r\n                if (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\r\n                    extended[prop] = extend(true, extended[prop], obj[prop]);\r\n                } else {\r\n                    extended[prop] = obj[prop];\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    // Loop through each object and conduct a merge\r\n    for (; i < length; i++) {\r\n        var obj = arguments[i];\r\n        merge(obj);\r\n    }\r\n\r\n    return extended;\r\n\r\n}\r\n\r\nvar validateOptions = function (option) {\r\n    var isValidArray = [];\r\n    var isValid = true;\r\n    isValidArray.push(validateHandler(option.defaultHandler));\r\n    isValidArray.push(validatePreCache(option.preCache));\r\n\r\n\r\n    isValidArray.forEach(function (item) {\r\n        if (!item) {\r\n            isValid = false;\r\n        }\r\n    })\r\n    return isValid;\r\n}\r\nvar notify_toolbox = function (configOption) {\r\n\r\n    //                var _defaultRequestType = 'any';\r\n    setDefault(configOption);\r\n    setUrls(configOption);\r\n    setStatic(configOption);\r\n    setDynamic(configOption);\r\n\r\n    // add default handler if some request does not match\r\n    //                toolbox.router.default = toolbox[configOption.defaultHandler];\r\n    notify.router.default = notify[getDefaultHandler()];\r\n\r\n}\r\n\r\nvar validateHandler = function (handler) {\r\n\r\n    if (typeof handler === 'string' && handler.length) {\r\n        // handler is a valid string\r\n\r\n        // check if the value exist the handlerArray\r\n        if (handlerArray.indexOf(handler) !== -1) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    } else {\r\n        return false;\r\n    }\r\n\r\n\r\n}\r\n\r\nvar validatePreCache = function (preCache) {\r\n    return Array.isArray(preCache);\r\n}\r\n\r\nvar validateRequestType = function (requestType) {\r\n    if (typeof requestType === 'string' && requestType.length) {\r\n        if (requestTypeArray.indexOf(requestType) !== -1) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    } else {\r\n        return false;\r\n    }\r\n\r\n}\r\nvar getDefaultHandler = function () {\r\n    return notify.options.defaultHandler;\r\n}\r\nvar getDefaultCacheName = function () {\r\n    return notify.options.cache.name;\r\n}\r\nvar getDefaultMaxAge = function () {\r\n    return notify.options.cache.maxAge;\r\n}\r\nvar getDefaultMaxLimit = function () {\r\n    return notify.options.cache.maxLimit;\r\n}\r\nvar getDefaultRequestType = function () {\r\n    var _defaultRequestType = 'any';\r\n    return _defaultRequestType;\r\n}\r\nvar setDefault = function (configOption) {\r\n    configOption.debug = true;\r\n    notify.options.debug = configOption.debug || false;\r\n    notify.options.cache.name = configOption.cache.name;\r\n    notify.options.cache.maxAgeSeconds = configOption.cache.maxAge;\r\n    notify.options.cache.maxEntries = configOption.cache.maxLimit;\r\n    notify.options.defaultHandler = configOption.defaultHandler;\r\n    notify.options.preCacheItems = configOption.preCache;\r\n    notify.options.navigationFallback = configOption.navigationFallback;\r\n}\r\nvar setUrls = function (configOption) {\r\n    if (configOption.hasOwnProperty('urls')) {\r\n        for (var urlPattern in configOption.urls) {\r\n            // console.log(url);\r\n            // check if the 'requestType' property is provided by the user for this url/express regex\r\n            // if not then we will default it to get() requestType\r\n            var _requestType = configOption.urls[urlPattern].requestType;\r\n            var _handler = configOption.urls[urlPattern].handler;\r\n            var _maxAge = configOption.urls[urlPattern].maxAge;\r\n            var _maxLimit = configOption.urls[urlPattern].maxLimit;\r\n            var _cacheName = configOption.cache.name;\r\n            var _origin = configOption.urls[urlPattern].origin;\r\n            if (_requestType && validateRequestType(_requestType)) {\r\n                // yes  'requestType' property is present\r\n                requestType[_requestType](urlPattern, _handler, _maxAge, _maxLimit, _cacheName, _origin);\r\n            } else {\r\n                // no 'requestType' property is not present\r\n                //  fallback to default\r\n                requestType[getDefaultRequestType()](urlPattern, _handler, _maxAge, _maxLimit, _cacheName, _origin);\r\n\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar setStatic = function (configOption) {\r\n    if (configOption.hasOwnProperty('staticFiles')) {\r\n        for (var key in configOption.staticFiles) {\r\n            var _requestType = configOption.staticFiles[key].requestType;\r\n            var _handler = configOption.staticFiles[key].handler || 'cacheFirst';\r\n            var _maxAge = configOption.staticFiles[key].maxAge;\r\n            var _maxLimit = configOption.staticFiles[key].maxLimit;\r\n            var _cacheName = getDefaultCacheName();\r\n            var _origin = configOption.staticFiles[key].origin;\r\n            var _urlPattern = configOption.staticFiles[key].urlPattern;\r\n            if (_requestType && validateRequestType(_requestType)) {\r\n                // yes  'requestType' property is present\r\n                requestType[_requestType](_urlPattern, _handler, _maxAge, _maxLimit, _cacheName, _origin);\r\n            } else {\r\n                // no 'requestType' property is not present\r\n                //  fallback to default\r\n                requestType[getDefaultRequestType()](_urlPattern, _handler, _maxAge, _maxLimit, _cacheName, _origin);\r\n\r\n            }\r\n        }\r\n    }\r\n}\r\nvar setDynamic = function (configOption) {\r\n    if (configOption.hasOwnProperty('dynamicFiles')) {\r\n        for (var key in configOption.dynamicFiles) {\r\n            var _requestType = configOption.dynamicFiles[key].requestType;\r\n            var _handler = configOption.dynamicFiles[key].handler || 'networkOnly';\r\n            var _maxAge = configOption.dynamicFiles[key].maxAge;\r\n            var _maxLimit = configOption.dynamicFiles[key].maxLimit;\r\n            var _cacheName = getDefaultCacheName();\r\n            var _origin = configOption.dynamicFiles[key].origin;\r\n            var _urlPattern = configOption.dynamicFiles[key].urlPattern;\r\n            if (_requestType && validateRequestType(_requestType)) {\r\n                // yes  'requestType' property is present\r\n                requestType[_requestType](_urlPattern, _handler, _maxAge, _maxLimit, _cacheName, _origin);\r\n            } else {\r\n                // no 'requestType' property is not present\r\n                //  fallback to default\r\n                requestType[getDefaultRequestType()](_urlPattern, _handler, _maxAge, _maxLimit, _cacheName, _origin);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar requestType = {\r\n    get: function (regex, handler, maxAge, maxLimit, cacheName, origin) {\r\n        // check if regex is valid or not \r\n        if (typeof regex === 'string' && regex.length) {\r\n            if (typeof origin === 'string' && origin.length) {\r\n                notify.router.any(\r\n                    regex,\r\n                    notify[handler] || getDefaultHandler(),\r\n                    {\r\n                        'cache':\r\n                        {\r\n                            'name': cacheName || getDefaultCacheName(),\r\n                            'maxAgeSeconds': maxAge || getDefaultMaxAge(),\r\n                            'maxEntries': maxLimit || getDefaultMaxLimit()\r\n                        },\r\n                        'origin': origin\r\n                    }\r\n                )\r\n            } else {\r\n                notify.router.any(\r\n                    regex,\r\n                    notify[handler] || getDefaultHandler(),\r\n                    {\r\n                        'cache':\r\n                        {\r\n                            'name': cacheName || getDefaultCacheName(),\r\n                            'maxAgeSeconds': maxAge || getDefaultMaxAge(),\r\n                            'maxEntries': maxLimit || getDefaultMaxLimit()\r\n                        }\r\n\r\n                    }\r\n                )\r\n            }\r\n        } else {\r\n            console.log('not a valid regex');\r\n            return;\r\n        }\r\n\r\n    },\r\n    post: function (regex, handler, maxAge, maxLimit, cacheName, origin) {\r\n        // check if regex is valid or not \r\n        if (typeof regex === 'string' && regex.length) {\r\n            if (typeof origin === 'string' && origin.length) {\r\n                notify.router.any(\r\n                    regex,\r\n                    notify[handler] || getDefaultHandler(),\r\n                    {\r\n                        'cache':\r\n                        {\r\n                            'name': cacheName || getDefaultCacheName(),\r\n                            'maxAgeSeconds': maxAge || getDefaultMaxAge(),\r\n                            'maxEntries': maxLimit || getDefaultMaxLimit()\r\n                        },\r\n                        'origin': origin\r\n                    }\r\n                )\r\n            } else {\r\n                notify.router.any(\r\n                    regex,\r\n                    notify[handler] || getDefaultHandler(),\r\n                    {\r\n                        'cache':\r\n                        {\r\n                            'name': cacheName || getDefaultCacheName(),\r\n                            'maxAgeSeconds': maxAge || getDefaultMaxAge(),\r\n                            'maxEntries': maxLimit || getDefaultMaxLimit()\r\n                        }\r\n\r\n                    }\r\n                )\r\n            }\r\n        } else {\r\n            console.log('not a valid regex');\r\n            return;\r\n        }\r\n    },\r\n    any: function (regex, handler, maxAge, maxLimit, cacheName, origin) {\r\n        // check if regex is valid or not \r\n        if (typeof regex === 'string' && regex.length) {\r\n            if (typeof origin === 'string' && origin.length) {\r\n                notify.router.any(\r\n                    regex,\r\n                    notify[handler] || getDefaultHandler(),\r\n                    {\r\n                        'cache':\r\n                        {\r\n                            'name': cacheName || getDefaultCacheName(),\r\n                            'maxAgeSeconds': maxAge || getDefaultMaxAge(),\r\n                            'maxEntries': maxLimit || getDefaultMaxLimit()\r\n                        },\r\n                        'origin': origin\r\n                    }\r\n                )\r\n            } else {\r\n                notify.router.any(\r\n                    regex,\r\n                    notify[handler] || getDefaultHandler(),\r\n                    {\r\n                        'cache':\r\n                        {\r\n                            'name': cacheName || getDefaultCacheName(),\r\n                            'maxAgeSeconds': maxAge || getDefaultMaxAge(),\r\n                            'maxEntries': maxLimit || getDefaultMaxLimit()\r\n                        }\r\n\r\n                    }\r\n                )\r\n            }\r\n        } else {\r\n            console.log('not a valid regex');\r\n            return;\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\nmodule.exports = {\r\n    extend: extend,\r\n    validateOptions: validateOptions,\r\n    notify_toolbox: notify_toolbox\r\n}","module.exports = Array.isArray || function (arr) {\n  return Object.prototype.toString.call(arr) == '[object Array]';\n};\n","var isarray = require('isarray')\n\n/**\n * Expose `pathToRegexp`.\n */\nmodule.exports = pathToRegexp\nmodule.exports.parse = parse\nmodule.exports.compile = compile\nmodule.exports.tokensToFunction = tokensToFunction\nmodule.exports.tokensToRegExp = tokensToRegExp\n\n/**\n * The main path matching regexp utility.\n *\n * @type {RegExp}\n */\nvar PATH_REGEXP = new RegExp([\n  // Match escaped characters that would otherwise appear in future matches.\n  // This allows the user to escape special characters that won't transform.\n  '(\\\\\\\\.)',\n  // Match Express-style parameters and un-named parameters with a prefix\n  // and optional suffixes. Matches appear as:\n  //\n  // \"/:test(\\\\d+)?\" => [\"/\", \"test\", \"\\d+\", undefined, \"?\", undefined]\n  // \"/route(\\\\d+)\"  => [undefined, undefined, undefined, \"\\d+\", undefined, undefined]\n  // \"/*\"            => [\"/\", undefined, undefined, undefined, undefined, \"*\"]\n  '([\\\\/.])?(?:(?:\\\\:(\\\\w+)(?:\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))?|\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))([+*?])?|(\\\\*))'\n].join('|'), 'g')\n\n/**\n * Parse a string for the raw tokens.\n *\n * @param  {string}  str\n * @param  {Object=} options\n * @return {!Array}\n */\nfunction parse (str, options) {\n  var tokens = []\n  var key = 0\n  var index = 0\n  var path = ''\n  var defaultDelimiter = options && options.delimiter || '/'\n  var res\n\n  while ((res = PATH_REGEXP.exec(str)) != null) {\n    var m = res[0]\n    var escaped = res[1]\n    var offset = res.index\n    path += str.slice(index, offset)\n    index = offset + m.length\n\n    // Ignore already escaped sequences.\n    if (escaped) {\n      path += escaped[1]\n      continue\n    }\n\n    var next = str[index]\n    var prefix = res[2]\n    var name = res[3]\n    var capture = res[4]\n    var group = res[5]\n    var modifier = res[6]\n    var asterisk = res[7]\n\n    // Push the current path onto the tokens.\n    if (path) {\n      tokens.push(path)\n      path = ''\n    }\n\n    var partial = prefix != null && next != null && next !== prefix\n    var repeat = modifier === '+' || modifier === '*'\n    var optional = modifier === '?' || modifier === '*'\n    var delimiter = res[2] || defaultDelimiter\n    var pattern = capture || group\n\n    tokens.push({\n      name: name || key++,\n      prefix: prefix || '',\n      delimiter: delimiter,\n      optional: optional,\n      repeat: repeat,\n      partial: partial,\n      asterisk: !!asterisk,\n      pattern: pattern ? escapeGroup(pattern) : (asterisk ? '.*' : '[^' + escapeString(delimiter) + ']+?')\n    })\n  }\n\n  // Match any characters still remaining.\n  if (index < str.length) {\n    path += str.substr(index)\n  }\n\n  // If the path exists, push it onto the end.\n  if (path) {\n    tokens.push(path)\n  }\n\n  return tokens\n}\n\n/**\n * Compile a string to a template function for the path.\n *\n * @param  {string}             str\n * @param  {Object=}            options\n * @return {!function(Object=, Object=)}\n */\nfunction compile (str, options) {\n  return tokensToFunction(parse(str, options))\n}\n\n/**\n * Prettier encoding of URI path segments.\n *\n * @param  {string}\n * @return {string}\n */\nfunction encodeURIComponentPretty (str) {\n  return encodeURI(str).replace(/[\\/?#]/g, function (c) {\n    return '%' + c.charCodeAt(0).toString(16).toUpperCase()\n  })\n}\n\n/**\n * Encode the asterisk parameter. Similar to `pretty`, but allows slashes.\n *\n * @param  {string}\n * @return {string}\n */\nfunction encodeAsterisk (str) {\n  return encodeURI(str).replace(/[?#]/g, function (c) {\n    return '%' + c.charCodeAt(0).toString(16).toUpperCase()\n  })\n}\n\n/**\n * Expose a method for transforming tokens into the path function.\n */\nfunction tokensToFunction (tokens) {\n  // Compile all the tokens into regexps.\n  var matches = new Array(tokens.length)\n\n  // Compile all the patterns before compilation.\n  for (var i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] === 'object') {\n      matches[i] = new RegExp('^(?:' + tokens[i].pattern + ')$')\n    }\n  }\n\n  return function (obj, opts) {\n    var path = ''\n    var data = obj || {}\n    var options = opts || {}\n    var encode = options.pretty ? encodeURIComponentPretty : encodeURIComponent\n\n    for (var i = 0; i < tokens.length; i++) {\n      var token = tokens[i]\n\n      if (typeof token === 'string') {\n        path += token\n\n        continue\n      }\n\n      var value = data[token.name]\n      var segment\n\n      if (value == null) {\n        if (token.optional) {\n          // Prepend partial segment prefixes.\n          if (token.partial) {\n            path += token.prefix\n          }\n\n          continue\n        } else {\n          throw new TypeError('Expected \"' + token.name + '\" to be defined')\n        }\n      }\n\n      if (isarray(value)) {\n        if (!token.repeat) {\n          throw new TypeError('Expected \"' + token.name + '\" to not repeat, but received `' + JSON.stringify(value) + '`')\n        }\n\n        if (value.length === 0) {\n          if (token.optional) {\n            continue\n          } else {\n            throw new TypeError('Expected \"' + token.name + '\" to not be empty')\n          }\n        }\n\n        for (var j = 0; j < value.length; j++) {\n          segment = encode(value[j])\n\n          if (!matches[i].test(segment)) {\n            throw new TypeError('Expected all \"' + token.name + '\" to match \"' + token.pattern + '\", but received `' + JSON.stringify(segment) + '`')\n          }\n\n          path += (j === 0 ? token.prefix : token.delimiter) + segment\n        }\n\n        continue\n      }\n\n      segment = token.asterisk ? encodeAsterisk(value) : encode(value)\n\n      if (!matches[i].test(segment)) {\n        throw new TypeError('Expected \"' + token.name + '\" to match \"' + token.pattern + '\", but received \"' + segment + '\"')\n      }\n\n      path += token.prefix + segment\n    }\n\n    return path\n  }\n}\n\n/**\n * Escape a regular expression string.\n *\n * @param  {string} str\n * @return {string}\n */\nfunction escapeString (str) {\n  return str.replace(/([.+*?=^!:${}()[\\]|\\/\\\\])/g, '\\\\$1')\n}\n\n/**\n * Escape the capturing group by escaping special characters and meaning.\n *\n * @param  {string} group\n * @return {string}\n */\nfunction escapeGroup (group) {\n  return group.replace(/([=!:$\\/()])/g, '\\\\$1')\n}\n\n/**\n * Attach the keys as a property of the regexp.\n *\n * @param  {!RegExp} re\n * @param  {Array}   keys\n * @return {!RegExp}\n */\nfunction attachKeys (re, keys) {\n  re.keys = keys\n  return re\n}\n\n/**\n * Get the flags for a regexp from the options.\n *\n * @param  {Object} options\n * @return {string}\n */\nfunction flags (options) {\n  return options.sensitive ? '' : 'i'\n}\n\n/**\n * Pull out keys from a regexp.\n *\n * @param  {!RegExp} path\n * @param  {!Array}  keys\n * @return {!RegExp}\n */\nfunction regexpToRegexp (path, keys) {\n  // Use a negative lookahead to match only capturing groups.\n  var groups = path.source.match(/\\((?!\\?)/g)\n\n  if (groups) {\n    for (var i = 0; i < groups.length; i++) {\n      keys.push({\n        name: i,\n        prefix: null,\n        delimiter: null,\n        optional: false,\n        repeat: false,\n        partial: false,\n        asterisk: false,\n        pattern: null\n      })\n    }\n  }\n\n  return attachKeys(path, keys)\n}\n\n/**\n * Transform an array into a regexp.\n *\n * @param  {!Array}  path\n * @param  {Array}   keys\n * @param  {!Object} options\n * @return {!RegExp}\n */\nfunction arrayToRegexp (path, keys, options) {\n  var parts = []\n\n  for (var i = 0; i < path.length; i++) {\n    parts.push(pathToRegexp(path[i], keys, options).source)\n  }\n\n  var regexp = new RegExp('(?:' + parts.join('|') + ')', flags(options))\n\n  return attachKeys(regexp, keys)\n}\n\n/**\n * Create a path regexp from string input.\n *\n * @param  {string}  path\n * @param  {!Array}  keys\n * @param  {!Object} options\n * @return {!RegExp}\n */\nfunction stringToRegexp (path, keys, options) {\n  return tokensToRegExp(parse(path, options), keys, options)\n}\n\n/**\n * Expose a function for taking tokens and returning a RegExp.\n *\n * @param  {!Array}          tokens\n * @param  {(Array|Object)=} keys\n * @param  {Object=}         options\n * @return {!RegExp}\n */\nfunction tokensToRegExp (tokens, keys, options) {\n  if (!isarray(keys)) {\n    options = /** @type {!Object} */ (keys || options)\n    keys = []\n  }\n\n  options = options || {}\n\n  var strict = options.strict\n  var end = options.end !== false\n  var route = ''\n\n  // Iterate over the tokens and create our regexp string.\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n\n    if (typeof token === 'string') {\n      route += escapeString(token)\n    } else {\n      var prefix = escapeString(token.prefix)\n      var capture = '(?:' + token.pattern + ')'\n\n      keys.push(token)\n\n      if (token.repeat) {\n        capture += '(?:' + prefix + capture + ')*'\n      }\n\n      if (token.optional) {\n        if (!token.partial) {\n          capture = '(?:' + prefix + '(' + capture + '))?'\n        } else {\n          capture = prefix + '(' + capture + ')?'\n        }\n      } else {\n        capture = prefix + '(' + capture + ')'\n      }\n\n      route += capture\n    }\n  }\n\n  var delimiter = escapeString(options.delimiter || '/')\n  var endsWithDelimiter = route.slice(-delimiter.length) === delimiter\n\n  // In non-strict mode we allow a slash at the end of match. If the path to\n  // match already ends with a slash, we remove it for consistency. The slash\n  // is valid at the end of a path match, not in the middle. This is important\n  // in non-ending mode, where \"/test/\" shouldn't match \"/test//route\".\n  if (!strict) {\n    route = (endsWithDelimiter ? route.slice(0, -delimiter.length) : route) + '(?:' + delimiter + '(?=$))?'\n  }\n\n  if (end) {\n    route += '$'\n  } else {\n    // In non-ending mode, we need the capturing groups to match as much as\n    // possible by using a positive lookahead to the end or next path segment.\n    route += strict && endsWithDelimiter ? '' : '(?=' + delimiter + '|$)'\n  }\n\n  return attachKeys(new RegExp('^' + route, flags(options)), keys)\n}\n\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n *\n * @param  {(string|RegExp|Array)} path\n * @param  {(Array|Object)=}       keys\n * @param  {Object=}               options\n * @return {!RegExp}\n */\nfunction pathToRegexp (path, keys, options) {\n  if (!isarray(keys)) {\n    options = /** @type {!Object} */ (keys || options)\n    keys = []\n  }\n\n  options = options || {}\n\n  if (path instanceof RegExp) {\n    return regexpToRegexp(path, /** @type {!Array} */ (keys))\n  }\n\n  if (isarray(path)) {\n    return arrayToRegexp(/** @type {!Array} */ (path), /** @type {!Array} */ (keys), options)\n  }\n\n  return stringToRegexp(/** @type {string} */ (path), /** @type {!Array} */ (keys), options)\n}\n","/**\n * Copyright 2015 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n(function() {\n  var nativeAddAll = Cache.prototype.addAll;\n  var userAgent = navigator.userAgent.match(/(Firefox|Chrome)\\/(\\d+\\.)/);\n\n  // Has nice behavior of `var` which everyone hates\n  if (userAgent) {\n    var agent = userAgent[1];\n    var version = parseInt(userAgent[2]);\n  }\n\n  if (\n    nativeAddAll && (!userAgent ||\n      (agent === 'Firefox' && version >= 46) ||\n      (agent === 'Chrome'  && version >= 50)\n    )\n  ) {\n    return;\n  }\n\n  Cache.prototype.addAll = function addAll(requests) {\n    var cache = this;\n\n    // Since DOMExceptions are not constructable:\n    function NetworkError(message) {\n      this.name = 'NetworkError';\n      this.code = 19;\n      this.message = message;\n    }\n\n    NetworkError.prototype = Object.create(Error.prototype);\n\n    return Promise.resolve().then(function() {\n      if (arguments.length < 1) throw new TypeError();\n\n      // Simulate sequence<(Request or USVString)> binding:\n      var sequence = [];\n\n      requests = requests.map(function(request) {\n        if (request instanceof Request) {\n          return request;\n        }\n        else {\n          return String(request); // may throw TypeError\n        }\n      });\n\n      return Promise.all(\n        requests.map(function(request) {\n          if (typeof request === 'string') {\n            request = new Request(request);\n          }\n\n          var scheme = new URL(request.url).protocol;\n\n          if (scheme !== 'http:' && scheme !== 'https:') {\n            throw new NetworkError(\"Invalid scheme\");\n          }\n\n          return fetch(request.clone());\n        })\n      );\n    }).then(function(responses) {\n      // If some of the responses has not OK-eish status,\n      // then whole operation should reject\n      if (responses.some(function(response) {\n        return !response.ok;\n      })) {\n        throw new NetworkError('Incorrect response status');\n      }\n\n      // TODO: check that requests don't overwrite one another\n      // (don't think this is possible to polyfill due to opaque responses)\n      return Promise.all(\n        responses.map(function(response, i) {\n          return cache.put(requests[i], response);\n        })\n      );\n    }).then(function() {\n      return undefined;\n    });\n  };\n\n  Cache.prototype.add = function add(request) {\n    return this.addAll([request]);\n  };\n}());"]}